<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Item Table</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input { margin-bottom: 10px; padding: 5px; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 10px; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: middle; }
    th { background: #f2f2f2; }
    tr:hover { background: #f9f9f9; cursor: pointer; }
    .pagination { margin-top: 10px; text-align: center; }

    td:first-child, th:first-child {
      max-width: 50%;  /* image column takes up to half width */
      width: 1%;
    }

    img.item-image {
      max-width: 100%;  /* scale within cell */
      height: auto;     /* keep proportions */
      display: block;
      margin: 0 auto;
    }

    button { padding: 5px 10px; margin: 0 5px; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
  </style>
</head>
<body>
  <h1>Item List</h1>

  <!-- Price filter -->
  <div id="filters">
    <label for="minPrice">Min Price: </label>
    <input type="number" id="minPrice" placeholder="0">

    <label for="maxPrice">Max Price: </label>
    <input type="number" id="maxPrice" placeholder="1000">

    <button id="applyFilter">Apply</button>
  </div>

  <!-- Table -->
  <table id="itemTable">
    <thead>
      <tr>
        <th>Image</th>
        <th>Name</th>
        <th>Category</th>
        <th>Price ($)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Pagination -->
  <div class="pagination">
    <button id="prevBtn">⬅ Previous</button>
    <span id="pageInfo"></span>
    <button id="nextBtn">Next ➡</button>
  </div>

  <script>
    let fullData = [];
    let filteredData = [];
    let currentPage = 1;
    const itemsPerPage = 20;

    // Load JSON data
    async function loadData() {
      const response = await fetch("items.json");
      fullData = await response.json();
      filteredData = fullData; // start with all items
      renderTable();
    }

    // Apply price filter only when button clicked
    function applyPriceFilter() {
      const min = parseFloat(document.getElementById('minPrice').value) || 0;
      const max = parseFloat(document.getElementById('maxPrice').value) || Infinity;

      filteredData = fullData.filter(item => {
        const price = parseFloat(item.price);
        return price >= min && price <= max;
      });

      currentPage = 1;
      renderTable();
    }

    // Render table with pagination
    function renderTable() {
      const tbody = document.querySelector('#itemTable tbody');
      tbody.innerHTML = '';

      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageItems = filteredData.slice(start, end);

      if (pageItems.length === 0) {
        tbody.innerHTML = `<tr><td colspan="4">No items found</td></tr>`;
        updatePagination();
        return;
      }

      pageItems.forEach(item => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><img src="${item.image}" alt="${item.name}" class="item-image"></td>
          <td>${item.name}</td>
          <td>${item.category}</td>
          <td>${Number(item.price).toFixed(2)}</td>
        `;
        row.addEventListener('click', () => {
          window.location.href = \`item.html?id=\${item.id}\`;
        });
        tbody.appendChild(row);
      });

      updatePagination();
    }

    // Update pagination buttons
    function updatePagination() {
      const totalPages = Math.ceil(filteredData.length / itemsPerPage);
      document.getElementById('pageInfo').innerText = \`Page \${currentPage} of \${totalPages || 1}\`;
      document.getElementById('prevBtn').disabled = currentPage === 1;
      document.getElementById('nextBtn').disabled = currentPage === totalPages || totalPages === 0;
    }

    // Pagination events
    document.getElementById('prevBtn').addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        renderTable();
      }
    });

    document.getElementById('nextBtn').addEventListener('click', () => {
      const totalPages = Math.ceil(filteredData.length / itemsPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        renderTable();
      }
    });

    // Hook up filter button
    document.getElementById('applyFilter').addEventListener('click', applyPriceFilter);

    loadData();
  </script>
</body>
</html>
